import './App.css';
import React, { useState, useEffect } from 'react';
import { Grid, Typography } from '@material-ui/core';
import SelectBy from './components/SelectBy.js';
import GridBox from './components/GridBox';
import data from './data/newData'
import { makeStyles } from '@material-ui/core/styles';
import Table from './components/Table';

const useStyles = makeStyles((theme) => ({
    root: {
      padding: '2rem',
      color: '#200550'
    },
    table: {
      // height: '100vh'
    },
    select: {
      flex: 'flex',
      paddingTop: '4rem'
    }
}));

function App() {
  const classes = useStyles();
  const [ location, setLocation ] = useState('all');
  const [ value, setValue ] = useState(6);
  const [ bankType, setBankType ] = useState('all')
  const [ filtered, setFiltered ] = useState([]);
  const [ currentPage, setCurrentPage ] = useState(1);

  const handleChangeLocation = (event) => {
      setLocation(event.target.value);
      setCurrentPage(1);
      filter();
  };

  const handleChangeBank = (event) => {
    setBankType(event.target.value);
    setCurrentPage(1);
    filter();
};

  const handleChangeSelect = (event) => {
      setValue(Number(event.target.value));
      setCurrentPage(1);
      filter();
  };
  
  console.log('location', location)
  console.log('bank', bankType)
  console.log('val', value)
  console.log('data', data)
  const filter = () => {
    let filteredData;
   
      switch(location) {
        case 'europe':
          filteredData = data.filter(item => item.stakeholderRegion === 'UK' || item.stakeholderRegion === 'Europe');
          break;
        case 'us':
          filteredData = data.filter(item => item.stakeholderRegion === 'North America');
          break;
        case 'asia':
          filteredData = data.filter(item => item.stakeholderRegion === 'APAC');
          break;
        case 'africa':
          filteredData = data.filter(item => item.stakeholderRegion === 'Africa & Middle East');
          break;
        case 'latinAmerica':
          filteredData = data.filter(item => item.stakeholderRegion === 'Latin America');
          break;
        default:
          filteredData = data;
      };
      switch(bankType) {
        case 'retail':
          filteredData = data.filter(item => item.bankType === 'Retail');
          break;
        case 'neobank':
          filteredData = data.filter(item => item.bankType === 'Neo' || item.bankType === 'Microfinance' || item.bankType === 'Fintech');
          break;
        case 'private':
          filteredData = data.filter(item => item.bankType === 'Commercial' || item.bankType === 'Investment' ||  item.bankType === 'Private');
          break;
        default:
          filteredData = data;
      };
      switch(value) {
        case 1:
          filteredData = filteredData.filter(item => item.existingPortfolioEnhancement.length);
          break;
        case 2:
          filteredData = filteredData.filter(item => item.newPortfolioExpansion.length);
          break;
        case 3:
          filteredData = filteredData.filter(item => item.efficiencyEnhancement.length);
          break;
        case 4:
          filteredData = filteredData.filter(item => item.networkOptimisation.length);
          break;
        case 5:
          filteredData = filteredData.filter(item => item.enhanceFinancialPerformance.length);
          break;
        default:
          filteredData = filteredData;
      };
      console.log(filteredData)
      setFiltered(filteredData);
  };

  useEffect(() => {
    filter();
  }, [ location, value, bankType ])

  return (
    <div className="App">
      <Grid container className={classes.root} align="center" justify="center" >
        <div className={classes.table}>
          <Typography variant="h5">Discover the value generated by bank APIs</Typography>
          <Table />
        </div>
        <Grid item md={12} align="center">
            <SelectBy
                handleChangeLocation={handleChangeLocation}
                handleChangeSelect={handleChangeSelect}
                handleChangeBank={handleChangeBank}
                location={location}
                valueProp={value}
                bankType={bankType}
            />
        </Grid>
        <Grid item md={12}>
            <GridBox banks={filtered}
              setCurrentPage={setCurrentPage}
              currentPage={currentPage}
              valueProp={value}
            />
        </Grid>
      </Grid>
    </div>
  );
}

export default App;
